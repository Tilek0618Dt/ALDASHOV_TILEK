import random
import re

# --- —Å—Ç–∏–ª —Ñ—Ä–∞–∑–∞–ª–∞—Ä (–∞—Ä–∞–ª–∞—à) ---
HUMOR = [
    "–≠—ç –¥–æ—Å—É–º üòÑ –∂–∞—à–æ–æ –∫—ã–∑—ã–∫ –¥–∞ —ç—ç!",
    "–•–∞—Ö–∞, —Ç“Ø—à“Ø–Ω–¥“Ø–º üòé",
    "–û–æ –±—É–ª —Ç–µ–º–∞ –∫–∞–π–Ω–∞—Ç–∞—Ç üî•",
]

KIND = [
    "–ñ–∞–∫—à—ã —Ç“Ø—à“Ø–Ω–¥“Ø–º, –¥–æ—Å—É–º ü§ù",
    "–ö–∞–ø–∞ –±–æ–ª–±–æ, –±–∞–∞—Ä—ã–Ω —á–µ—á–µ–±–∏–∑ üí™",
    "–ú–µ–Ω –∂–∞–Ω—ã–Ω–¥–∞–º—ã–Ω, —á–æ–≥—É—É —á—ã–≥–∞—Ä–∞–±—ã–∑ ‚ú®",
]

HONEST = [
    "–ß—ã–Ω—á—ã–ª –∞–π—Ç–∞–π—ã–Ω:",
    "–¢—É—É—Ä–∞—Å—ã–Ω –∞–π—Ç—Å–∞–º:",
    "–ñ–∞—à—ã—Ä–±–∞–π –∞–π—Ç–∞–º:",
]

SERIOUS = [
    "–ú—É–Ω—É —Å–µ—Ä—å—ë–∑–Ω—ã–π –∫–∞–±—ã–ª –∞–ª, –¥–æ—Å—É–º.",
    "–ë—É–ª –∂–µ—Ä–¥–µ —Ç–∞–∫ –∂–æ–æ–ø –∫–µ—Ä–µ–∫.",
    "–ë—É–ª –º–∞–∞–Ω–∏–ª“Ø“Ø —Ç–µ–º–∞ ‚Äî –∫”©“£“Ø–ª –±—É—Ä–∞–ª—ã.",
]

GENIUS = [
    "–ö–µ–ª –ª–æ–≥–∏–∫–∞ –º–µ–Ω–µ–Ω —Ä–∞–∑–±–æ—Ä –∫—ã–ª–∞–π–ª—ã üß†",
    "–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ã–ª—ã–ø –∫–µ—Ç–µ–ª–∏ üöÄ",
    "–°–∏—Å—Ç–µ–º–∞–ª—É—É —á–µ—á–∏–º —á—ã–≥–∞—Ä–∞–ª—ã ‚öôÔ∏è",
]

CLOSERS = [
    "–î–æ—Å—É–º üòéüíé",
    "–¢–µ–Ω –∫—ã–ª—ã–ø –±–µ—Ä–¥–∏–º üíé",
    "–ö–µ—Ç—Ç–∏–∫! üî•",
    "–ö–∞–ø–∞ –±–æ–ª–±–æ, –±–∞–∞—Ä—ã –±–æ–ª–æ—Ç ‚ú®",
]

EMOJIS = ["üòé", "üíé", "üî•", "‚ö°", "‚ú®", "üöÄ", "üß†", "ü§ù"]

def _is_serious(text: str) -> bool:
    t = text.lower()
    keywords = [
        "–∫—ã–π—ã–Ω", "–∫—ã–π—ã–Ω—á—ã–ª—ã–∫", "–¥–µ–ø—Ä–µ—Å—Å", "–æ–æ—Ä", "–∂–∞—Ä–¥–∞–º",
        "—ç–º–Ω–µ –∫—ã–ª—ã—à", "–∫–æ—Ä–∫—É–ø", "–ø—Ä–æ–±–ª–µ–º", "–∞–∫—á–∞ –∂–æ–∫", "—É–π–∫—É –∂–æ–∫",
        "–∂–∞–º–∞–Ω", "—Å—Ç—Ä–µ—Å—Å"
    ]
    return any(k in t for k in keywords)

def _pick_mix(serious: bool) -> str:
    """
    MIX = 5: –±–∞–∞—Ä—ã —Ç–µ“£. –ë–∏—Ä–æ–∫ serious –±–æ–ª—Å–æ —é–º–æ—Ä–¥—É –∞–∑–∞–π—Ç–∞—Ç.
    """
    parts = []
    # —Å—Ç–∞—Ä—Ç (–±–æ–æ—Ä—É–∫–µ—Ä/—á—ã–Ω—á—ã–ª/–≥–µ–Ω–∏–π/—é–º–æ—Ä)
    if serious:
        parts.append(random.choice(SERIOUS))
        parts.append(random.choice(KIND))
        # —á—ã–Ω—á—ã–ª + —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
        parts.append(random.choice(HONEST))
        parts.append(random.choice(GENIUS))
    else:
        # –∂–µ“£–∏–ª —Ç–µ–º–∞–¥–∞ —é–º–æ—Ä + –±–æ–æ—Ä—É–∫–µ—Ä + –≥–µ–Ω–∏–π
        parts.append(random.choice(HUMOR))
        parts.append(random.choice(KIND))
        if random.random() < 0.6:
            parts.append(random.choice(GENIUS))
        if random.random() < 0.6:
            parts.append(random.choice(HONEST))

    return " ".join(parts)

def tilek_style(answer: str, user_text: str = "") -> str:
    serious = _is_serious(user_text)
    head = _pick_mix(serious)
    emoji = random.choice(EMOJIS)
    close = random.choice(CLOSERS)

    # –∂–æ–æ–ø—Ç—É —Ç–∞–∑–∞ –∫—ã–ª—ã–ø –±–µ—Ä–µ–ª–∏
    answer = answer.strip()
    if not answer:
        answer = "–¢“Ø—à“Ø–Ω–¥“Ø–º, –¥–æ—Å—É–º. –ö–∞–π—Å—ã –∂–∞–≥—ã–Ω —Ç–∞–∫—Ç–∞–π–±—ã–∑? üôÇ"

    return f"{head}\n\n{answer}\n\n{close} {emoji}"
